{"title":"DFMB-generate_data","uid":"80bdf4334493e2cc51bf0382bdaa975b","slug":"DFMB-generate_data","date":"2025-10-29T16:00:00.000Z","updated":"2025-11-04T14:15:35.888Z","comments":true,"path":"api/articles/DFMB-generate_data.json","keywords":null,"cover":null,"content":"<p>以下为实验代码：</p>\n<p>主要用于解析基因本体(GO)数据库的层级结构，并针对蛋白质的三个功能类别（生物过程、分子功能、细胞组分）分别处理训练集和测试集数据，生成包含蛋白质ID列表、功能注释关系和蛋白质序列的标准化文件，为后续深度学习模型提供结构化的输入数据。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> math</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> click <span class=\"keyword\">as</span> ck</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> pickle <span class=\"keyword\">as</span> pkl</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> gzip</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">from</span> collections <span class=\"keyword\">import</span> deque, Counter,defaultdict</span><br><span class=\"line\"></span><br><span class=\"line\">AAS = &#123;<span class=\"string\">&#x27;M&#x27;</span>: <span class=\"number\">18</span>, <span class=\"string\">&#x27;F&#x27;</span>: <span class=\"number\">15</span>, <span class=\"string\">&#x27;A&#x27;</span>: <span class=\"number\">3</span>, <span class=\"string\">&#x27;P&#x27;</span>: <span class=\"number\">9</span>, <span class=\"string\">&#x27;I&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;D&#x27;</span>: <span class=\"number\">11</span>, <span class=\"string\">&#x27;V&#x27;</span>: <span class=\"number\">6</span>, <span class=\"string\">&#x27;K&#x27;</span>: <span class=\"number\">7</span>, <span class=\"string\">&#x27;S&#x27;</span>: <span class=\"number\">2</span>, <span class=\"string\">&#x27;N&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;W&#x27;</span>: <span class=\"number\">20</span>, <span class=\"string\">&#x27;T&#x27;</span>: <span class=\"number\">10</span>, <span class=\"string\">&#x27;G&#x27;</span>: <span class=\"number\">4</span>, <span class=\"string\">&#x27;L&#x27;</span>: <span class=\"number\">1</span>, <span class=\"string\">&#x27;Y&#x27;</span>: <span class=\"number\">16</span>, <span class=\"string\">&#x27;E&#x27;</span>: <span class=\"number\">5</span>, <span class=\"string\">&#x27;H&#x27;</span>: <span class=\"number\">17</span>, <span class=\"string\">&#x27;R&#x27;</span>: <span class=\"number\">8</span>, <span class=\"string\">&#x27;Q&#x27;</span>: <span class=\"number\">14</span>, <span class=\"string\">&#x27;C&#x27;</span>: <span class=\"number\">19</span>&#125;</span><br><span class=\"line\"><span class=\"comment\">#将20种氨基酸的单字母代码映射到数字</span></span><br><span class=\"line\"></span><br><span class=\"line\">BIOLOGICAL_PROCESS = <span class=\"string\">&#x27;GO:0008150&#x27;</span></span><br><span class=\"line\">MOLECULAR_FUNCTION = <span class=\"string\">&#x27;GO:0003674&#x27;</span></span><br><span class=\"line\">CELLULAR_COMPONENT = <span class=\"string\">&#x27;GO:0005575&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">FUNC_DICT = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;cc&#x27;</span>: CELLULAR_COMPONENT,</span><br><span class=\"line\">    <span class=\"string\">&#x27;mf&#x27;</span>: MOLECULAR_FUNCTION,</span><br><span class=\"line\">    <span class=\"string\">&#x27;bp&#x27;</span>: BIOLOGICAL_PROCESS&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">NAMESPACES = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;cc&#x27;</span>: <span class=\"string\">&#x27;cellular_component&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;mf&#x27;</span>: <span class=\"string\">&#x27;molecular_function&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;bp&#x27;</span>: <span class=\"string\">&#x27;biological_process&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">NAMESPACES_reverse = &#123;</span><br><span class=\"line\">     <span class=\"string\">&#x27;cellular_component&#x27;</span>:<span class=\"string\">&#x27;cc&#x27;</span>,</span><br><span class=\"line\">     <span class=\"string\">&#x27;molecular_function&#x27;</span>: <span class=\"string\">&#x27;mf&#x27;</span>,</span><br><span class=\"line\">     <span class=\"string\">&#x27;biological_process&#x27;</span>:<span class=\"string\">&#x27;bp&#x27;</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">#模型性能评估的四个指标</span></span><br><span class=\"line\">evaluations = [<span class=\"string\">&#x27;precision&#x27;</span>,<span class=\"string\">&#x27;recall&#x27;</span>,<span class=\"string\">&#x27;fmax&#x27;</span>,<span class=\"string\">&#x27;aupr&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Ontology</span>(<span class=\"title class_ inherited__\">object</span>):</span><br><span class=\"line\">    <span class=\"comment\">#ont 是一个字典，它存储了从obo文件中解析出来的所有术语</span></span><br><span class=\"line\">    <span class=\"comment\">#ic是信息内容（Information Content）被用来衡量一个基因功能术语（GO Term）的特定性。</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, filename=<span class=\"string\">&#x27;./uniprot_sprot_train_test_data_oral/go.obo&#x27;</span>, with_rels=<span class=\"literal\">False</span></span>):</span><br><span class=\"line\">        <span class=\"comment\">#obo文件：记录了所有基因功能的定义和层级关系</span></span><br><span class=\"line\">        <span class=\"comment\">#with_rels=False：不加载详细的关系类型</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.ont = <span class=\"variable language_\">self</span>.load(filename, with_rels)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.ic = <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">has_term</span>(<span class=\"params\">self, term_id</span>):</span><br><span class=\"line\">        <span class=\"keyword\">return</span> term_id <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ont</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#计算每个功能的&quot;稀有度评分&quot;</span></span><br><span class=\"line\">    <span class=\"comment\">#annots:蛋白质的功能注释列表</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">calculate_ic</span>(<span class=\"params\">self, annots</span>):</span><br><span class=\"line\">    <span class=\"comment\">#annots = [</span></span><br><span class=\"line\">    <span class=\"comment\"># 每个小列表代表一个蛋白质的&quot;功能简历&quot;</span></span><br><span class=\"line\">    <span class=\"comment\">#[&#x27;GO:0008150&#x27;, &#x27;GO:0003674&#x27;, &#x27;GO:0005575&#x27;],  # 蛋白质1的功能</span></span><br><span class=\"line\">    <span class=\"comment\">#[&#x27;GO:0008150&#x27;, &#x27;GO:0003674&#x27;],                 # 蛋白质2的功能  </span></span><br><span class=\"line\">    <span class=\"comment\">#[&#x27;GO:0005575&#x27;, &#x27;GO:0009987&#x27;],                 # 蛋白质3的功能</span></span><br><span class=\"line\">    <span class=\"comment\">#[&#x27;GO:0008150&#x27;],                               # 蛋白质4的功能</span></span><br><span class=\"line\">    <span class=\"comment\"># ... 成千上万个蛋白质</span></span><br><span class=\"line\">    <span class=\"comment\">#]</span></span><br><span class=\"line\">        cnt = Counter()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> annots:</span><br><span class=\"line\">            cnt.update(x)</span><br><span class=\"line\">        <span class=\"comment\">#cnt是一个键值对的合集，记录了每个GO术语出现的次数</span></span><br><span class=\"line\">        <span class=\"comment\">#cnt = &#123;&#x27;GO:0008150&#x27;: 2, &#x27;GO:0003674&#x27;: 2, &#x27;GO:0005575&#x27;: 1&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.ic = &#123;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> go_id, n <span class=\"keyword\">in</span> cnt.items():</span><br><span class=\"line\">            parents = <span class=\"variable language_\">self</span>.get_parents(go_id)<span class=\"comment\"># 获取直接父功能</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(parents) == <span class=\"number\">0</span>:</span><br><span class=\"line\">                min_n = n<span class=\"comment\"># 如果没有父功能，用自己的次数</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                min_n = <span class=\"built_in\">min</span>([cnt[x] <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> parents])<span class=\"comment\"># 找父功能中最小的次数</span></span><br><span class=\"line\">            <span class=\"variable language_\">self</span>.ic[go_id] = math.log(min_n / n, <span class=\"number\">2</span>)<span class=\"comment\"># 计算IC</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_ic</span>(<span class=\"params\">self, go_id</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"variable language_\">self</span>.ic <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">            <span class=\"keyword\">raise</span> Exception(<span class=\"string\">&#x27;Not yet calculated&#x27;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> go_id <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ic:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0.0</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">self</span>.ic[go_id]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#把文本格式的OBO文件转换成内存中的结构化数据</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">load</span>(<span class=\"params\">self, filename, with_rels</span>):</span><br><span class=\"line\">        <span class=\"comment\">#ont 是一个字典</span></span><br><span class=\"line\">        <span class=\"comment\">#ont[obj[&#x27;id&#x27;]] 是字典的键值对，键：obj[&#x27;id&#x27;]，值：obj这个对象</span></span><br><span class=\"line\">        ont = <span class=\"built_in\">dict</span>()</span><br><span class=\"line\">        obj = <span class=\"literal\">None</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(filename, <span class=\"string\">&#x27;r&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> f:</span><br><span class=\"line\">                line = line.strip()</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> line:</span><br><span class=\"line\">                    <span class=\"keyword\">continue</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> line == <span class=\"string\">&#x27;[Term]&#x27;</span>:<span class=\"comment\"># 开始一个新的术语块</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> obj <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">                        ont[obj[<span class=\"string\">&#x27;id&#x27;</span>]] = obj<span class=\"comment\"># 如果已经有在处理的术语，先保存</span></span><br><span class=\"line\">                    obj = <span class=\"built_in\">dict</span>()<span class=\"comment\"># 创建新的术语对象并初始化</span></span><br><span class=\"line\">                    obj[<span class=\"string\">&#x27;is_a&#x27;</span>] = <span class=\"built_in\">list</span>()</span><br><span class=\"line\">                    obj[<span class=\"string\">&#x27;part_of&#x27;</span>] = <span class=\"built_in\">list</span>()</span><br><span class=\"line\">                    obj[<span class=\"string\">&#x27;regulates&#x27;</span>] = <span class=\"built_in\">list</span>()</span><br><span class=\"line\">                    obj[<span class=\"string\">&#x27;alt_ids&#x27;</span>] = <span class=\"built_in\">list</span>()</span><br><span class=\"line\">                    obj[<span class=\"string\">&#x27;is_obsolete&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\">                    <span class=\"keyword\">continue</span></span><br><span class=\"line\">                <span class=\"keyword\">elif</span> line == <span class=\"string\">&#x27;[Typedef]&#x27;</span>:</span><br><span class=\"line\">                    obj = <span class=\"literal\">None</span></span><br><span class=\"line\">                <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> obj <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">                        <span class=\"keyword\">continue</span></span><br><span class=\"line\">                    l = line.split(<span class=\"string\">&quot;: &quot;</span>)<span class=\"comment\"># 分割键值对</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> l[<span class=\"number\">0</span>] == <span class=\"string\">&#x27;id&#x27;</span>:</span><br><span class=\"line\">                        obj[<span class=\"string\">&#x27;id&#x27;</span>] = l[<span class=\"number\">1</span>]</span><br><span class=\"line\">                    <span class=\"keyword\">elif</span> l[<span class=\"number\">0</span>] == <span class=\"string\">&#x27;alt_id&#x27;</span>:</span><br><span class=\"line\">                        obj[<span class=\"string\">&#x27;alt_ids&#x27;</span>].append(l[<span class=\"number\">1</span>])</span><br><span class=\"line\">                    <span class=\"keyword\">elif</span> l[<span class=\"number\">0</span>] == <span class=\"string\">&#x27;namespace&#x27;</span>:</span><br><span class=\"line\">                        obj[<span class=\"string\">&#x27;namespace&#x27;</span>] = l[<span class=\"number\">1</span>]</span><br><span class=\"line\">                    <span class=\"keyword\">elif</span> l[<span class=\"number\">0</span>] == <span class=\"string\">&#x27;is_a&#x27;</span>:</span><br><span class=\"line\">                        obj[<span class=\"string\">&#x27;is_a&#x27;</span>].append(l[<span class=\"number\">1</span>].split(<span class=\"string\">&#x27; ! &#x27;</span>)[<span class=\"number\">0</span>])</span><br><span class=\"line\">                    <span class=\"keyword\">elif</span> with_rels <span class=\"keyword\">and</span> l[<span class=\"number\">0</span>] == <span class=\"string\">&#x27;relationship&#x27;</span>:</span><br><span class=\"line\">                        it = l[<span class=\"number\">1</span>].split()</span><br><span class=\"line\">                        <span class=\"comment\"># add all types of relationships</span></span><br><span class=\"line\">                        <span class=\"keyword\">if</span> it[<span class=\"number\">0</span>] == <span class=\"string\">&#x27;part_of&#x27;</span>:</span><br><span class=\"line\">                            obj[<span class=\"string\">&#x27;is_a&#x27;</span>].append(it[<span class=\"number\">1</span>])</span><br><span class=\"line\">                            </span><br><span class=\"line\">                    <span class=\"keyword\">elif</span> l[<span class=\"number\">0</span>] == <span class=\"string\">&#x27;name&#x27;</span>:</span><br><span class=\"line\">                        obj[<span class=\"string\">&#x27;name&#x27;</span>] = l[<span class=\"number\">1</span>]</span><br><span class=\"line\">                    <span class=\"keyword\">elif</span> l[<span class=\"number\">0</span>] == <span class=\"string\">&#x27;is_obsolete&#x27;</span> <span class=\"keyword\">and</span> l[<span class=\"number\">1</span>] == <span class=\"string\">&#x27;true&#x27;</span>:</span><br><span class=\"line\">                        obj[<span class=\"string\">&#x27;is_obsolete&#x27;</span>] = <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> obj <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">            ont[obj[<span class=\"string\">&#x27;id&#x27;</span>]] = obj</span><br><span class=\"line\">        <span class=\"comment\">#处理别名和过时术语</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> term_id <span class=\"keyword\">in</span> <span class=\"built_in\">list</span>(ont.keys()):<span class=\"comment\"># 遍历本体中的所有术语</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> t_id <span class=\"keyword\">in</span> ont[term_id][<span class=\"string\">&#x27;alt_ids&#x27;</span>]:<span class=\"comment\"># 遍历每个术语的所有别名</span></span><br><span class=\"line\">                ont[t_id] = ont[term_id]<span class=\"comment\"># 把别名的术语指向本体中的原始术语</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> ont[term_id][<span class=\"string\">&#x27;is_obsolete&#x27;</span>]:<span class=\"comment\"># 如果术语是过时术语就删掉</span></span><br><span class=\"line\">                <span class=\"keyword\">del</span> ont[term_id]</span><br><span class=\"line\">        <span class=\"comment\">#构造父子关系</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> term_id, val <span class=\"keyword\">in</span> ont.items():</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"string\">&#x27;children&#x27;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> val:</span><br><span class=\"line\">                val[<span class=\"string\">&#x27;children&#x27;</span>] = <span class=\"built_in\">set</span>()</span><br><span class=\"line\">            <span class=\"keyword\">for</span> p_id <span class=\"keyword\">in</span> val[<span class=\"string\">&#x27;is_a&#x27;</span>]:<span class=\"comment\"># 遍历每个术语的所有父节点</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> p_id <span class=\"keyword\">in</span> ont:<span class=\"comment\"># 如果父节点存在于本体中</span></span><br><span class=\"line\">            <span class=\"comment\"># 把当前术语添加到父节点的children集合中</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> <span class=\"string\">&#x27;children&#x27;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> ont[p_id]:</span><br><span class=\"line\">                        ont[p_id][<span class=\"string\">&#x27;children&#x27;</span>] = <span class=\"built_in\">set</span>()</span><br><span class=\"line\">                    ont[p_id][<span class=\"string\">&#x27;children&#x27;</span>].add(term_id)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ont</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_anchestors</span>(<span class=\"params\">self, term_id</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> term_id <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ont:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">set</span>()</span><br><span class=\"line\">        term_set = <span class=\"built_in\">set</span>()</span><br><span class=\"line\">        q = deque()</span><br><span class=\"line\">        q.append(term_id)</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(<span class=\"built_in\">len</span>(q) &gt; <span class=\"number\">0</span>):</span><br><span class=\"line\">            t_id = q.popleft()</span><br><span class=\"line\">            <span class=\"keyword\">if</span> t_id <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> term_set:</span><br><span class=\"line\">                term_set.add(t_id)</span><br><span class=\"line\">                <span class=\"keyword\">for</span> parent_id <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ont[t_id][<span class=\"string\">&#x27;is_a&#x27;</span>]:</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> parent_id <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ont:</span><br><span class=\"line\">                        q.append(parent_id)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> term_set</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#只返回直接父节点</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_parents</span>(<span class=\"params\">self, term_id</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> term_id <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ont:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">set</span>()</span><br><span class=\"line\">        term_set = <span class=\"built_in\">set</span>()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> parent_id <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ont[term_id][<span class=\"string\">&#x27;is_a&#x27;</span>]:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> parent_id <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ont:</span><br><span class=\"line\">                term_set.add(parent_id)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> term_set</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#获取指定命名空间下的所有术语</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_namespace_terms</span>(<span class=\"params\">self, namespace</span>):</span><br><span class=\"line\">        terms = <span class=\"built_in\">set</span>()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> go_id, obj <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ont.items():</span><br><span class=\"line\">            <span class=\"keyword\">if</span> obj[<span class=\"string\">&#x27;namespace&#x27;</span>] == namespace:</span><br><span class=\"line\">                terms.add(go_id)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> terms</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#获取指定术语的命名空间</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_namespace</span>(<span class=\"params\">self, term_id</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> term_id <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ont:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable language_\">self</span>.ont[term_id][<span class=\"string\">&#x27;namespace&#x27;</span>]</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&#x27;can not find&#x27;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#使用BFS获取术语的所有后代节点（包括自身）</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_term_set</span>(<span class=\"params\">self, term_id</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> term_id <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ont:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">set</span>()</span><br><span class=\"line\">        term_set = <span class=\"built_in\">set</span>()</span><br><span class=\"line\">        q = deque()</span><br><span class=\"line\">        q.append(term_id)</span><br><span class=\"line\">        <span class=\"keyword\">while</span> <span class=\"built_in\">len</span>(q) &gt; <span class=\"number\">0</span>:</span><br><span class=\"line\">            t_id = q.popleft()</span><br><span class=\"line\">            <span class=\"keyword\">if</span> t_id <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> term_set:</span><br><span class=\"line\">                term_set.add(t_id)</span><br><span class=\"line\">                <span class=\"keyword\">for</span> ch_id <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.ont[t_id][<span class=\"string\">&#x27;children&#x27;</span>]:</span><br><span class=\"line\">                    q.append(ch_id)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> term_set</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#为训练集生成三种类型的文件，用于后续的模型训练</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;/home/wbshi/work/yunyanshuai/benchmark/DataProcess/interpro_feature_PPI/PPI_dict_index_protein.pkl&#x27;</span>,<span class=\"string\">&#x27;rb&#x27;</span>) <span class=\"keyword\">as</span> fr:</span><br><span class=\"line\">    dict_ppi_index_protein=pkl.load(fr)</span><br><span class=\"line\">    <span class=\"comment\">#将索引映射到蛋白质ID的字典</span></span><br><span class=\"line\">    <span class=\"comment\">#&#123;0: &#x27;P12345&#x27;, 1: &#x27;Q67890&#x27;, 2: &#x27;A1B2C3&#x27;, ...&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;./data/ppi_pid_list.txt&#x27;</span>,<span class=\"string\">&#x27;w&#x27;</span>) <span class=\"keyword\">as</span> fw:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(dict_ppi_index_protein)):</span><br><span class=\"line\">        fw.write(dict_ppi_index_protein[i]+<span class=\"string\">&quot;\\n&quot;</span>)</span><br><span class=\"line\">    <span class=\"comment\">#创建一个包含所有蛋白质ID的txt文件</span></span><br><span class=\"line\">    </span><br><span class=\"line\">f=<span class=\"built_in\">open</span>(<span class=\"string\">&#x27;../../DataProcess/inputdata/train_data_separate.pkl&#x27;</span>,<span class=\"string\">&#x27;rb&#x27;</span>)</span><br><span class=\"line\">train=pkl.load(f)</span><br><span class=\"line\"><span class=\"comment\">#读取训练集</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">go_file=<span class=\"string\">&#x27;../../DataProcess/inputdata/go.obo&#x27;</span></span><br><span class=\"line\">go = Ontology(go_file, with_rels=<span class=\"literal\">True</span>)</span><br><span class=\"line\"><span class=\"comment\">#创建一个Ontology对象</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#生成18个文件</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> class_type <span class=\"keyword\">in</span> [<span class=\"string\">&#x27;test1&#x27;</span>,<span class=\"string\">&#x27;test2&#x27;</span>]:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> class_tag <span class=\"keyword\">in</span> [<span class=\"string\">&#x27;bp&#x27;</span>,<span class=\"string\">&#x27;cc&#x27;</span>,<span class=\"string\">&#x27;mf&#x27;</span>]:</span><br><span class=\"line\">        <span class=\"comment\">#提取名为 proteins 的这一列</span></span><br><span class=\"line\">test_proteins_list=<span class=\"built_in\">list</span>(pd.read_csv(<span class=\"string\">&#x27;../../DataProcess/inputdata/&#123;0&#125;_data_separate_&#123;1&#125;_proteins.csv&#x27;</span>.<span class=\"built_in\">format</span>(class_type,class_tag))[<span class=\"string\">&#x27;proteins&#x27;</span>]) </span><br><span class=\"line\">        <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;../../DataProcess/inputdata/&#123;0&#125;_data_separate.pkl&#x27;</span>.<span class=\"built_in\">format</span>(class_type),<span class=\"string\">&#x27;rb&#x27;</span>) <span class=\"keyword\">as</span> fr:</span><br><span class=\"line\">            test_one=pkl.load(fr)</span><br><span class=\"line\">            </span><br><span class=\"line\">        <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;./data/&#123;0&#125;_&#123;1&#125;_pid_list.txt&#x27;</span>.<span class=\"built_in\">format</span>(class_tag,class_type), <span class=\"string\">&#x27;w&#x27;</span>) <span class=\"keyword\">as</span> f: </span><br><span class=\"line\">            <span class=\"keyword\">for</span> protein <span class=\"keyword\">in</span> test_proteins_list:</span><br><span class=\"line\">                f.write(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;protein&#125;</span>\\n&#x27;</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;./data/&#123;0&#125;_&#123;1&#125;_go.txt&#x27;</span>.<span class=\"built_in\">format</span>(class_tag,class_type), <span class=\"string\">&#x27;w&#x27;</span>) <span class=\"keyword\">as</span> f:    </span><br><span class=\"line\">            <span class=\"keyword\">for</span> protein <span class=\"keyword\">in</span> test_proteins_list:</span><br><span class=\"line\">                value = test_one[protein]  <span class=\"comment\"># 获取蛋白质数据</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> go_id <span class=\"keyword\">in</span> value[<span class=\"string\">f&#x27;all_<span class=\"subst\">&#123;class_tag&#125;</span>&#x27;</span>]:  <span class=\"comment\"># 遍历该蛋白质的所有功能</span></span><br><span class=\"line\">                    annot_set = go.get_anchestors(go_id)  <span class=\"comment\"># 获取功能的所有上级</span></span><br><span class=\"line\">                    <span class=\"keyword\">for</span> annot_id <span class=\"keyword\">in</span> annot_set:  <span class=\"comment\"># 遍历所有上级功能</span></span><br><span class=\"line\">                        <span class=\"keyword\">if</span> go.get_namespace(annot_id) == NAMESPACES[class_tag]:  <span class=\"comment\"># 检查类别</span></span><br><span class=\"line\">                            f.write(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;protein&#125;</span>\\t<span class=\"subst\">&#123;annot_id&#125;</span>\\t<span class=\"subst\">&#123;class_tag&#125;</span>\\n&#x27;</span>)  <span class=\"comment\"># 写入关系</span></span><br><span class=\"line\">                            </span><br><span class=\"line\">        <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;./data/&#123;0&#125;_&#123;1&#125;.fasta&#x27;</span>.<span class=\"built_in\">format</span>(class_tag,class_type), <span class=\"string\">&#x27;w&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> protein <span class=\"keyword\">in</span> test_proteins_list:</span><br><span class=\"line\">                value=test_one[protein]</span><br><span class=\"line\">                seq=value[<span class=\"string\">&#x27;sequences&#x27;</span>]</span><br><span class=\"line\">                f.write(<span class=\"string\">f&#x27;&gt;<span class=\"subst\">&#123;protein&#125;</span>\\n<span class=\"subst\">&#123;seq&#125;</span>\\n&#x27;</span>)</span><br><span class=\"line\">                </span><br><span class=\"line\"><span class=\"keyword\">for</span> class_type <span class=\"keyword\">in</span> [<span class=\"string\">&#x27;train&#x27;</span>]:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> class_tag <span class=\"keyword\">in</span> [<span class=\"string\">&#x27;bp&#x27;</span>,<span class=\"string\">&#x27;cc&#x27;</span>,<span class=\"string\">&#x27;mf&#x27;</span>]:</span><br><span class=\"line\">        train_all_proteins_list=<span class=\"built_in\">list</span>(pd.read_csv(<span class=\"string\">&#x27;../../DataProcess/inputdata/&#123;0&#125;_data_separate_&#123;1&#125;_proteins.csv&#x27;</span>.<span class=\"built_in\">format</span>(class_type,class_tag))[<span class=\"string\">&#x27;proteins&#x27;</span>])</span><br><span class=\"line\">        <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;./data/&#123;0&#125;_&#123;1&#125;_pid_list.txt&#x27;</span>.<span class=\"built_in\">format</span>(class_tag,class_type), <span class=\"string\">&#x27;w&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> protein <span class=\"keyword\">in</span> train_all_proteins_list:</span><br><span class=\"line\">                f.write(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;protein&#125;</span>\\n&#x27;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;./data/&#123;0&#125;_&#123;1&#125;_go.txt&#x27;</span>.<span class=\"built_in\">format</span>(class_tag,class_type), <span class=\"string\">&#x27;w&#x27;</span>) <span class=\"keyword\">as</span> f:  </span><br><span class=\"line\">            <span class=\"keyword\">for</span> protein <span class=\"keyword\">in</span> train_all_proteins_list:</span><br><span class=\"line\">                value=train[protein]</span><br><span class=\"line\">                <span class=\"keyword\">for</span> go_id <span class=\"keyword\">in</span> value[<span class=\"string\">f&#x27;all_<span class=\"subst\">&#123;class_tag&#125;</span>&#x27;</span>]:</span><br><span class=\"line\">                    annot_set = go.get_anchestors(go_id)</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> annot_id <span class=\"keyword\">in</span> annot_set:</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> go.get_namespace(annot_id) == NAMESPACES[class_tag]:</span><br><span class=\"line\">                            f.write(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;protein&#125;</span>\\t<span class=\"subst\">&#123;annot_id&#125;</span>\\t<span class=\"subst\">&#123;class_tag&#125;</span>\\n&#x27;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;./data/&#123;0&#125;_&#123;1&#125;.fasta&#x27;</span>.<span class=\"built_in\">format</span>(class_tag,class_type), <span class=\"string\">&#x27;w&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> protein <span class=\"keyword\">in</span> train_all_proteins_list:</span><br><span class=\"line\">                value=train[protein]</span><br><span class=\"line\">                seq=value[<span class=\"string\">&#x27;sequences&#x27;</span>]</span><br><span class=\"line\">                f.write(<span class=\"string\">f&#x27;&gt;<span class=\"subst\">&#123;protein&#125;</span>\\n<span class=\"subst\">&#123;seq&#125;</span>\\n&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n","text":"以下为实验代码： 主要用于解析基因本体(GO)数据库的层级结构，并针对蛋白质的三个功能类别（生物过程、分子功能、细胞组分）分别处理训练集和测试集数据，生成包含蛋...","permalink":"/post/DFMB-generate_data","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"DeepFMB","slug":"DeepFMB","count":7,"path":"api/categories/DeepFMB.json"}],"tags":[{"name":"项目","slug":"项目","count":7,"path":"api/tags/项目.json"}],"toc":"","author":{"name":"Qushubiao","slug":"blog-author","avatar":"https://s2.loli.net/2025/10/18/RHJMI8AE6TVS21l.jpg","link":"/","description":"做难事必有所得","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"DFMB-preprocessing","uid":"54f39c547c269df1bc57406b3c3efac2","slug":"DFMB-preprocessing","date":"2025-11-04T16:00:00.000Z","updated":"2025-11-04T14:19:35.670Z","comments":true,"path":"api/articles/DFMB-preprocessing.json","keywords":null,"cover":[],"text":"​ 这是一个蛋白质相互作用网络(PPI)的图数据处理脚本，它通过加载稀疏矩阵格式的PPI网络数据，为每个蛋白质节点保留权重最高的前top个连接边，添加自环并进行...","permalink":"/post/DFMB-preprocessing","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"DeepFMB","slug":"DeepFMB","count":7,"path":"api/categories/DeepFMB.json"}],"tags":[{"name":"项目","slug":"项目","count":7,"path":"api/tags/项目.json"}],"author":{"name":"Qushubiao","slug":"blog-author","avatar":"https://s2.loli.net/2025/10/18/RHJMI8AE6TVS21l.jpg","link":"/","description":"做难事必有所得","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"DFMB-generate_esm_graph","uid":"024d1f7df937a3339d4af68acb9edd21","slug":"DFMB-generate_esm_graph","date":"2025-10-27T16:00:00.000Z","updated":"2025-11-04T13:45:41.350Z","comments":true,"path":"api/articles/DFMB-generate_esm_graph.json","keywords":null,"cover":[],"text":" 这个主要是用来生成esm特征的。将每个蛋白质当成索引，找到他们的esm特征向量，把行号用蛋白质的名称来表示，列的数量不一定，因为每个特征维度的大小不同，将其转...","permalink":"/post/DFMB-generate_esm_graph","photos":[],"count_time":{"symbolsCount":102,"symbolsTime":"1 mins."},"categories":[{"name":"DeepFMB","slug":"DeepFMB","count":7,"path":"api/categories/DeepFMB.json"}],"tags":[{"name":"项目","slug":"项目","count":7,"path":"api/tags/项目.json"}],"author":{"name":"Qushubiao","slug":"blog-author","avatar":"https://s2.loli.net/2025/10/18/RHJMI8AE6TVS21l.jpg","link":"/","description":"做难事必有所得","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}